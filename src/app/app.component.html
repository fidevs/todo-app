<app-current-task *ngIf="currentTasks.length > 0"></app-current-task>

<div class="container">
  <div id="task-list-container">
    <div id="tool-bar">
      <mat-form-field appearance="legacy">
        <mat-label>Filtrar por estatus</mat-label>
        <mat-select [(ngModel)]="filter">
          <mat-option value="ALL">Todas</mat-option>
          <mat-option value="PENDING">Pendientes</mat-option>
          <mat-option value="COMPLETED">Completadas</mat-option>
        </mat-select>
      </mat-form-field>

      <div class="sort-section">
        <mat-form-field appearance="legacy">
          <mat-label>Ordenar por</mat-label>
          <mat-select [(ngModel)]="sortBy">
            <mat-option value="desc">Descripci贸n</mat-option>
            <mat-option value="date">Fecha de finalizaci贸n</mat-option>
            <mat-option value="duration">Duraci贸n</mat-option>
            <mat-option value="delay">Duraci贸n de la tarea</mat-option>
            <mat-option value="status">Estado</mat-option>
          </mat-select>
        </mat-form-field>
        <button mat-icon-button (click)="this.orderAsc = !this.orderAsc">
          <mat-icon>{{
            orderAsc ? "vertical_align_top" : "vertical_align_bottom"
          }}</mat-icon>
        </button>
      </div>

      <mat-form-field class="example-form-field" appearance="legacy">
        <mat-label>Buscar tarea</mat-label>
        <input
          #searchBox
          [(ngModel)]="search"
          matInput
          type="text"
          (input)="searchTask(searchBox.value)"
        />
        <button
          *ngIf="searchBox.value"
          matSuffix
          mat-icon-button
          aria-label="Clear"
          (click)="clearInput()"
        >
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

      <button
        *ngIf="!savingTask"
        mat-icon-button
        style="color: rgb(39, 112, 155)"
        matTooltip="Registrar tarea"
        (click)="recordNewTask()"
      >
        <mat-icon>add_circle</mat-icon>
      </button>

      <div *ngIf="savingTask" style="margin-top: auto; margin-bottom: auto">
        <mat-progress-spinner
          diameter="20"
          color="primary"
          mode="indeterminate"
        >
        </mat-progress-spinner>
      </div>

      <button
        *ngIf="!searchingList"
        mat-icon-button
        style="color: rgb(0, 0, 0)"
        matTooltip="Actualizar lista de tareas"
        (click)="refreshList()"
      >
        <mat-icon>sync</mat-icon>
      </button>

      <div *ngIf="searchingList" style="margin-top: auto; margin-bottom: auto">
        <mat-progress-spinner
          diameter="20"
          color="primary"
          mode="indeterminate"
        >
        </mat-progress-spinner>
      </div>
    </div>
    <div id="task-list">
      <app-task *ngFor="let task of list$ | async" [task]="task" ></app-task>
    </div>
  </div>

  <app-pending-task></app-pending-task>
</div>
